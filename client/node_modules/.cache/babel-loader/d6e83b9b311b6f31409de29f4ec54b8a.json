{"ast":null,"code":"var _jsxFileName = \"C:\\\\project\\\\MusicBolt-master\\\\MusicBolt-master\\\\client\\\\src\\\\user\\\\UserDashboard.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Base from \"../core/Base\";\nimport Card from \"../core/Card\";\nimport { getNewTracks, getRecommendationTracks, getSearchQueryResults, getUserFavourites, getTrackById } from \"./helper/userApiCalls\";\nimport { isAuthenticated } from \"../auth/helper\";\n\nconst UserDashboard = () => {\n  const [tracks, setTracks] = useState([]);\n  const [favourites, setFavourites] = useState([]);\n  const [recommendations, setRecommendations] = useState([]);\n  const [searchResults, setSearchResults] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(false);\n  const trackTypes = [\"popular\", \"latest\", \"upcoming\", \"onsale\"];\n  const {\n    user,\n    token\n  } = isAuthenticated();\n  var delayTimer;\n\n  const loadNewTracks = () => {\n    console.log(token);\n    console.log(data);\n    getNewTracks(token).then(data => {\n      if (data.error) {\n        setError(data.error);\n      } else {\n        setTracks([...tracks, ...data]);\n        console.log(\"New Tracks fetched\");\n      }\n    });\n  };\n\n  const loadUserFavourites = async () => {\n    let favList = [];\n    let userData = await getUserFavourites(token, user);\n\n    if (userData.favourites) {\n      let l = userData.favourites.length;\n      userData.favourites.forEach(async (fav, ind) => {\n        let data = await getTrackById(token, fav.id);\n        if (data) favList.push(data);\n\n        if (ind == l - 1) {\n          // console.log(favList);\n          setFavourites(favList);\n        }\n      });\n    }\n  };\n\n  const loadRecommendations = () => {\n    getRecommendationTracks(token, user).then(data => {\n      if (data.error) {\n        setError(data.error);\n      } else {\n        console.log(data);\n        let recs = [];\n        let len = data.length;\n        data.forEach((trackId, ind) => {\n          getTrackById(token, trackId).then(track => {\n            if (track) recs.push(track);\n\n            if (ind == len - 1) {\n              setRecommendations([...recommendations, ...recs]);\n              console.log(\"Recommendation Tracks fetched\");\n            }\n          }).catch(err => console.log(err));\n        });\n      }\n    });\n  };\n\n  const execSearchQuery = txt => {\n    if (txt) {\n      clearTimeout(delayTimer);\n      delayTimer = setTimeout(function () {\n        console.log(\"SEACRHING: \", txt);\n        setLoading(true);\n        getSearchQueryResults(token, user, txt).then(data => {\n          if (data && data.error) {\n            setError(data.error);\n          } else if (data.length) {\n            console.log(\"Data: \", data);\n            let res = [];\n            let l = data.length;\n            data.forEach((id, ind) => {\n              getTrackById(token, id).then(track => {\n                res.push(track);\n\n                if (ind == l - 1) {\n                  setSearchResults(res);\n                  console.log(\"Search Query Results fetched\");\n                }\n              }).catch(err => console.log(err));\n            });\n          }\n\n          setLoading(false);\n        }).catch(err => console.log(err));\n      }, 1000);\n    } else {\n      clearTimeout(delayTimer);\n      setSearchResults([]);\n    }\n  };\n\n  const loadingMsg = () => {\n    return React.createElement(\"img\", {\n      className: \"col-1\",\n      src: \"../imgs/loading.gif\",\n      style: {\n        display: loading ? \"block\" : \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    });\n  };\n\n  useEffect(() => {\n    loadNewTracks();\n    loadUserFavourites();\n    loadRecommendations();\n  }, []);\n  return React.createElement(Base, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, React.createElement(\"section\", {\n    className: \"container mt-5\",\n    id: \"songsSection\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"seach\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fas fa-search text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, \"\\xA0\"), \"Search something\")), React.createElement(\"input\", {\n    type: \"text\",\n    onChange: e => execSearchQuery(e.target.value),\n    className: \"form-control\",\n    id: \"searchQuery\",\n    placeholder: \"Song / artist / album\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  })), loadingMsg(), React.createElement(\"div\", {\n    className: \"row grid mb-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, searchResults && searchResults.map((track, index) => {\n    // console.log(track.name, index);\n    return React.createElement(\"div\", {\n      key: index,\n      className: `col-lg-3 col-md-6 col-sm-12 element-item track mb-4 ${trackTypes[Math.floor(Math.random() * trackTypes.length)]}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(Card, {\n      track: track,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }));\n  })), React.createElement(\"nav\", {\n    className: \"mt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"nav nav-fill nav-lg nav-tabs\",\n    id: \"nav-tab\",\n    role: \"tablist\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    className: \"nav-item nav-link active\",\n    id: \"nav-tracks-tab\",\n    \"data-toggle\": \"tab\",\n    href: \"#nav-tracks\",\n    role: \"tab\",\n    \"aria-controls\": \"nav-tracks\",\n    \"aria-selected\": \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, \"Tracks\")), React.createElement(\"a\", {\n    className: \"nav-item nav-link\",\n    id: \"nav-fav-tab\",\n    \"data-toggle\": \"tab\",\n    href: \"#nav-fav\",\n    role: \"tab\",\n    \"aria-controls\": \"nav-fav\",\n    \"aria-selected\": \"false\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, \"Favourites\")), React.createElement(\"a\", {\n    className: \"nav-item nav-link\",\n    id: \"nav-rec-tab\",\n    \"data-toggle\": \"tab\",\n    href: \"#nav-rec\",\n    role: \"tab\",\n    \"aria-controls\": \"nav-fav\",\n    \"aria-selected\": \"false\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, \"Recommendations\")))), React.createElement(\"div\", {\n    className: \"tab-content\",\n    id: \"nav-tabContent\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"tab-pane fade show active\",\n    id: \"nav-tracks\",\n    role: \"tabpanel\",\n    \"aria-labelledby\": \"nav-home-tab\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"tracks-area\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"button-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"button\",\n    \"data-filter\": \"*\",\n    className: \"active\",\n    id: \"btn1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, \"All\"), React.createElement(\"button\", {\n    type: \"button\",\n    \"data-filter\": \".popular\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, \"Popular\"), React.createElement(\"button\", {\n    type: \"button\",\n    \"data-filter\": \".latest\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, \"Latest\"), React.createElement(\"button\", {\n    type: \"button\",\n    \"data-filter\": \".upcoming\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, \"Upcoming\")), React.createElement(\"div\", {\n    className: \"row grid mt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, tracks && tracks.map((track, index) => {\n    // console.log(track.name, index);\n    if (favourites.findIndex(fav => fav.id == track.id) == -1) {\n      return React.createElement(\"div\", {\n        key: index,\n        className: `col-lg-4 col-md-6 col-sm-12 element-item track mb-4 ${trackTypes[Math.floor(Math.random() * trackTypes.length)]}`,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, React.createElement(Card, {\n        track: track,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }));\n    }\n  })))), React.createElement(\"div\", {\n    className: \"tab-pane fade\",\n    id: \"nav-fav\",\n    role: \"tabpanel\",\n    \"aria-labelledby\": \"nav-fav-tab\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row grid mt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, favourites && favourites.map((fav, index) => {\n    return React.createElement(\"div\", {\n      key: index,\n      className: `col-lg-4 col-md-6 col-sm-12 element-item track mb-4`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }, React.createElement(Card, {\n      track: fav,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }));\n  }))), React.createElement(\"div\", {\n    className: \"tab-pane fade\",\n    id: \"nav-rec\",\n    role: \"tabpanel\",\n    \"aria-labelledby\": \"nav-rec-tab\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row grid mt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249\n    },\n    __self: this\n  }, recommendations && recommendations.map((rec, index) => {\n    return React.createElement(\"div\", {\n      key: index,\n      className: `col-lg-4 col-md-6 col-sm-12 element-item track mb-4`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }, React.createElement(Card, {\n      track: rec,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }));\n  }))))));\n};\n\nexport default UserDashboard;","map":{"version":3,"sources":["C:/project/MusicBolt-master/MusicBolt-master/client/src/user/UserDashboard.js"],"names":["React","useState","useEffect","Link","Base","Card","getNewTracks","getRecommendationTracks","getSearchQueryResults","getUserFavourites","getTrackById","isAuthenticated","UserDashboard","tracks","setTracks","favourites","setFavourites","recommendations","setRecommendations","searchResults","setSearchResults","loading","setLoading","error","setError","trackTypes","user","token","delayTimer","loadNewTracks","console","log","data","then","loadUserFavourites","favList","userData","l","length","forEach","fav","ind","id","push","loadRecommendations","recs","len","trackId","track","catch","err","execSearchQuery","txt","clearTimeout","setTimeout","res","loadingMsg","display","e","target","value","map","index","Math","floor","random","findIndex","rec"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Base from \"../core/Base\";\nimport Card from \"../core/Card\";\nimport { getNewTracks, getRecommendationTracks, getSearchQueryResults, getUserFavourites, getTrackById } from \"./helper/userApiCalls\";\nimport { isAuthenticated } from \"../auth/helper\";\n\nconst UserDashboard = () => {\n\tconst [tracks, setTracks] = useState([]);\n\tconst [favourites, setFavourites] = useState([]);\n\tconst [recommendations, setRecommendations] = useState([]);\n\tconst [searchResults, setSearchResults] = useState([]);\n\tconst [loading, setLoading] = useState(false);\n\tconst [error, setError] = useState(false);\n\tconst trackTypes = [\"popular\", \"latest\", \"upcoming\", \"onsale\"];\n\tconst { user, token } = isAuthenticated();\n\n\tvar delayTimer;\n\n\tconst loadNewTracks = () => {\n\t\tconsole.log(token);\n\t\tconsole.log(data);\n\t\tgetNewTracks(token).then(data => {\n\t\t\tif (data.error) {\n\t\t\t\tsetError(data.error);\n\t\t\t} else {\n\t\t\t\tsetTracks([...tracks, ...data]);\n\t\t\t\tconsole.log(\"New Tracks fetched\");\n\t\t\t}\n\t\t});\n\t};\n\n\tconst loadUserFavourites = async () => {\n\t\tlet favList = [];\n\t\tlet userData = await getUserFavourites(token, user);\n\t\tif (userData.favourites) {\n\t\t\tlet l = userData.favourites.length;\n\t\t\tuserData.favourites.forEach(async (fav, ind) => {\n\t\t\t\tlet data = await getTrackById(token, fav.id);\n\t\t\t\tif (data)\n\t\t\t\t\tfavList.push(data);\n\t\t\t\tif (ind == l - 1) {\n\t\t\t\t\t// console.log(favList);\n\t\t\t\t\tsetFavourites(favList);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst loadRecommendations = () => {\n\t\tgetRecommendationTracks(token, user).then(data => {\n\t\t\tif (data.error) {\n\t\t\t\tsetError(data.error);\n\t\t\t} else {\n\t\t\t\tconsole.log(data);\n\t\t\t\tlet recs = [];\n\t\t\t\tlet len = data.length;\n\t\t\t\tdata.forEach((trackId, ind) => {\n\t\t\t\t\tgetTrackById(token, trackId)\n\t\t\t\t\t\t.then(track => {\n\t\t\t\t\t\t\tif(track)\n\t\t\t\t\t\t\t\trecs.push(track);\n\t\t\t\t\t\t\tif (ind == len - 1) {\n\t\t\t\t\t\t\t\tsetRecommendations([...recommendations, ...recs]);\n\t\t\t\t\t\t\t\tconsole.log(\"Recommendation Tracks fetched\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(err => console.log(err));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tconst execSearchQuery = (txt) => {\n\t\tif (txt){\n\t\t\tclearTimeout(delayTimer);\n\t\t\tdelayTimer = setTimeout(function() {\n\t\t\t\tconsole.log(\"SEACRHING: \", txt);\n\t\t\t\tsetLoading(true);\n\t\t\t\tgetSearchQueryResults(token, user, txt)\n\t\t\t\t\t.then(data => {\n\t\t\t\t\t\tif(data && data.error){\n\t\t\t\t\t\t\tsetError(data.error)\n\t\t\t\t\t\t}else if(data.length){\n\t\t\t\t\t\t\tconsole.log(\"Data: \", data);\n\t\t\t\t\t\t\tlet res = [];\n\t\t\t\t\t\t\tlet l = data.length;\n\t\t\t\t\t\t\tdata.forEach((id, ind) => {\n\t\t\t\t\t\t\t\tgetTrackById(token, id)\n\t\t\t\t\t\t\t\t\t.then(track => {\n\t\t\t\t\t\t\t\t\t\tres.push(track);\n\t\t\t\t\t\t\t\t\t\tif (ind == l - 1) {\n\t\t\t\t\t\t\t\t\t\t\tsetSearchResults(res);\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"Search Query Results fetched\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(err => console.log(err));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => console.log(err));\n\t\t\t}, 1000);\n\t\t}else{\n\t\t\tclearTimeout(delayTimer);\n\t\t\tsetSearchResults([]);\n\t\t}\n\t};\n\n\tconst loadingMsg = () => {\n\t\treturn (\n\t\t\t<img className=\"col-1\" src=\"../imgs/loading.gif\" style={{ display: loading ? \"block\" : \"none\" }}/>\n\t\t);\n\t};\n\n\tuseEffect(() => {\n\t\tloadNewTracks();\n\t\tloadUserFavourites();\n\t\tloadRecommendations();\n\t}, []);\n\n\n\treturn (\n\t\t<Base>\n\t\t\t<section className=\"container mt-5\" id=\"songsSection\">\n\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t<label htmlFor=\"seach\"><h4><i className=\"fas fa-search text-muted\">&nbsp;</i>Search something</h4></label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tonChange={e => execSearchQuery(e.target.value)}\n\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\tid=\"searchQuery\"\n\t\t\t\t\t\tplaceholder=\"Song / artist / album\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{loadingMsg()}\n\t\t\t\t<div className=\"row grid mb-3\">\n\t\t\t\t\t{searchResults && \n\t\t\t\t\t\tsearchResults.map((track, index) => {\n\t\t\t\t\t\t// console.log(track.name, index);\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\tclassName={`col-lg-3 col-md-6 col-sm-12 element-item track mb-4 ${\n\t\t\t\t\t\t\t\t\ttrackTypes[Math.floor(Math.random() * trackTypes.length)]\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Card track={track} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<nav className=\"mt-5\">\n\t\t\t\t\t<div className=\"nav nav-fill nav-lg nav-tabs\" id=\"nav-tab\" role=\"tablist\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclassName=\"nav-item nav-link active\"\n\t\t\t\t\t\t\tid=\"nav-tracks-tab\"\n\t\t\t\t\t\t\tdata-toggle=\"tab\"\n\t\t\t\t\t\t\thref=\"#nav-tracks\"\n\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\taria-controls=\"nav-tracks\"\n\t\t\t\t\t\t\taria-selected=\"true\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<h3>Tracks</h3>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclassName=\"nav-item nav-link\"\n\t\t\t\t\t\t\tid=\"nav-fav-tab\"\n\t\t\t\t\t\t\tdata-toggle=\"tab\"\n\t\t\t\t\t\t\thref=\"#nav-fav\"\n\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\taria-controls=\"nav-fav\"\n\t\t\t\t\t\t\taria-selected=\"false\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<h3>Favourites</h3>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclassName=\"nav-item nav-link\"\n\t\t\t\t\t\t\tid=\"nav-rec-tab\"\n\t\t\t\t\t\t\tdata-toggle=\"tab\"\n\t\t\t\t\t\t\thref=\"#nav-rec\"\n\t\t\t\t\t\t\trole=\"tab\"\n\t\t\t\t\t\t\taria-controls=\"nav-fav\"\n\t\t\t\t\t\t\taria-selected=\"false\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<h3>Recommendations</h3>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</nav>\n\t\t\t\t<div className=\"tab-content\" id=\"nav-tabContent\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"tab-pane fade show active\"\n\t\t\t\t\t\tid=\"nav-tracks\"\n\t\t\t\t\t\trole=\"tabpanel\"\n\t\t\t\t\t\taria-labelledby=\"nav-home-tab\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"tracks-area\">\n\t\t\t\t\t\t\t<div className=\"button-group\">\n\t\t\t\t\t\t\t\t<button type=\"button\" data-filter=\"*\" className=\"active\" id=\"btn1\">\n\t\t\t\t\t\t\t\t\tAll\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button type=\"button\" data-filter=\".popular\">\n\t\t\t\t\t\t\t\t\tPopular\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button type=\"button\" data-filter=\".latest\">\n\t\t\t\t\t\t\t\t\tLatest\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button type=\"button\" data-filter=\".upcoming\">\n\t\t\t\t\t\t\t\t\tUpcoming\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"row grid mt-5\">\n\t\t\t\t\t\t\t\t{/* {console.log(tracks)} */}\n\t\t\t\t\t\t\t\t{tracks &&\n\t\t\t\t\t\t\t\t\ttracks.map((track, index) => {\n\t\t\t\t\t\t\t\t\t\t// console.log(track.name, index);\n\t\t\t\t\t\t\t\t\t\tif (favourites.findIndex(fav => fav.id == track.id) == -1) {\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`col-lg-4 col-md-6 col-sm-12 element-item track mb-4 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrackTypes[Math.floor(Math.random() * trackTypes.length)]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Card track={track} />\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"tab-pane fade\" id=\"nav-fav\" role=\"tabpanel\" aria-labelledby=\"nav-fav-tab\">\n\t\t\t\t\t\t<div className=\"row grid mt-5\">\n\t\t\t\t\t\t\t{favourites &&\n\t\t\t\t\t\t\t\tfavourites.map((fav, index) => {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\tclassName={`col-lg-4 col-md-6 col-sm-12 element-item track mb-4`}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Card track={fav} />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"tab-pane fade\" id=\"nav-rec\" role=\"tabpanel\" aria-labelledby=\"nav-rec-tab\">\n\t\t\t\t\t\t<div className=\"row grid mt-5\">\n\t\t\t\t\t\t\t{recommendations &&\n\t\t\t\t\t\t\t\trecommendations.map((rec, index) => {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\tclassName={`col-lg-4 col-md-6 col-sm-12 element-item track mb-4`}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Card track={rec} />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</Base>\n\t);\n};\n\nexport default UserDashboard;\n"]},"metadata":{},"sourceType":"module"}